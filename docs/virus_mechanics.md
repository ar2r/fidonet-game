# Механика вируса "Курочка Ряба"

## Концепция

Вирус "Курочка Ряба" — аутентичная механика из 1995 года, добавляющая атмосферность и создающая игровое событие между Act 1 и Act 2.

## Исторический контекст

**"Курочка Ряба"** (Chicken Little, USSR-1989) — один из первых российских вирусов с визуальными эффектами. Назван в честь русской народной сказки. Оригинальный вирус рисовал ASCII-курочку на экране.

Другие известные вирусы того времени:
- **Cascade** (1987) — символы "падали" вниз по экрану
- **Ping Pong** (1988) — мячик отскакивал от краёв экрана
- **Walker** (1989) — человечек шёл по нижней строке
- **AIDSTEST** (1989, Д.Лозинский) — первый российский антивирус

## Игровая механика

### Заражение

1. **Источник**: DOOM2.WAD на BBS (файл #3 в файловой области)
2. **Триггер**: Запуск команды `DOOM2` или `DOOM2.WAD` в терминале
3. **Визуальные эффекты**:
   - Cascade effect — символы кириллицы падают вниз (3 секунды)
   - Появляется ASCII-арт курочки
   - Сообщение "ВИРУС 'КУРОЧКА РЯБА' — ВАШ КОМПЬЮТЕР ЗАРАЖЁН!"
   - Экран трясётся (shake animation)

### Последствия

- **Санити**: -20 (immediate)
- **Терпение мамы**: -10 (она видит глюки на экране)
- **Блокировка**: Невозможно запустить DOOM2.WAD повторно пока активен вирус
- **Состояние**: `virusActive: true`, `virusStage: 'cascade'`

### Лечение

1. **Антивирус**: AIDSTEST.EXE (файл #4 на BBS)
2. **Команда**: `AIDSTEST` или `AIDSTEST.EXE`
3. **Процесс**:
   - Анимация сканирования (5 секунд)
   - Обнаружение вируса: "VIRUS/Kurochka.Ryaba"
   - Прогресс-бар лечения
   - Сообщение "Компьютер вылечен!"
4. **Результат**: `virusActive: false`, `virusStage: 'none'`

## Технические детали

### Redux State

```javascript
gameState: {
  virusActive: boolean,      // Активен ли вирус
  virusStage: string,        // 'none' | 'cascade' | 'cleaning'
}
```

### Компонент VirusAnimation

**Файл**: `src/components/VirusAnimation.jsx`

**Стадии анимации**:
1. **'cascade'** — Падающие символы + ASCII-курочка
2. **'cleaning'** — Анимация работы AIDSTEST
3. **'none'** — Вирус неактивен, компонент не рендерится

**Эффекты**:
- `cascade` keyframe — падение символов сверху вниз
- `blink` keyframe — мигающий текст
- `shake` keyframe — тряска экрана

### Команды в commandParser

#### DOOM2 / DOOM2.WAD
```javascript
- Проверяет наличие 'doom2' в inventory
- Активирует вирус через 1 секунду (dispatch setVirusActive, setVirusStage)
- Применяет штрафы к статам
```

#### AIDSTEST / AIDSTEST.EXE
```javascript
- Проверяет virusActive
- Если вирус неактивен → "Вирусов не обнаружено"
- Если активен → запускает анимацию 'cleaning'
- Через 5 секунд деактивирует вирус
```

## Игровой процесс

### Сценарий 1: Любопытный игрок

1. Игрок скачивает DOOM2.WAD с BBS
2. Запускает `DOOM2` в терминале
3. **БАХ!** — Экран заражён вирусом
4. Паника: санити -20, мама -10
5. Игрок читает подсказку: "Наберите AIDSTEST"
6. Возвращается на BBS → скачивает AIDSTEST (#4)
7. Запускает `AIDSTEST` → система вылечена

### Сценарий 2: Осторожный игрок

1. Игрок видит AIDSTEST.EXE в файловой области
2. Скачивает антивирус "на всякий случай"
3. Позже скачивает DOOM2.WAD
4. Запускает → заражён
5. Уже имеет AIDSTEST → быстро лечит систему

## Интеграция в сюжет

**Момент**: Между Act 1 (Download Software) и Act 2 (Configure Software)

**Цель**:
- Создать запоминающееся событие
- Добавить риск исследованию BBS
- Показать, что не всё скачанное безопасно
- Научить игрока осторожности в 90-х

## ASCII-арт курочки

```
    ___
  /o   o\
 (   ^   )
  \_____/
   |   |
  /|   |\
 / |   | \
   ||_||
   || ||
  _||_||_
```

## Падающие символы

Используется кириллица: АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯабвгдеёжзийклмнопрстуфхцчшщъыьэюя + цифры + спецсимволы

## Будущие улучшения

- **Звуки**: Beep-звуки при заражении (Web Audio API)
- **Дополнительные вирусы**: Cascade (чистый), Ping-Pong (игровой)
- **Квест**: "Вирус охотник" — найти и вылечить 3 разных вируса
- **Последствия**: Если не лечить долго → потеря файлов (симуляция)
- **Антивирусные базы**: Обновления AIDSTEST через BBS

## Ссылки

- [История AIDSTEST](https://ru.wikipedia.org/wiki/AIDSTEST)
- [Вирусы 90-х в СССР](https://web.archive.org/web/20080509024633/http://www.viruslist.com/ru/analysis?pubid=200247719)
- [Курочка Ряба (USSR-1989)](https://en.wikipedia.org/wiki/Chicken_(computer_virus))
